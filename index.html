<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 È¶ñÁàæ 8 Â§© 7 Â§úÔΩú‰∫§ÈÄöÈ¢®Èö™Ê†°Ê≠£ÁµÇÊ•µÁâà</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        .app-height { height: 100dvh; }
        
        /* Mobile Layout: Map 30%, List 70% */
        #map-container { height: 30%; } 
        @media (min-width: 768px) {
            #map-container { height: 100%; }
            .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        }

        /* Markdown-like note styling */
        .note-content { white-space: pre-wrap; word-break: break-word; }
    </style>
</head>
<body class="bg-gray-100 text-slate-800 font-sans overflow-hidden">

    <div id="app" class="flex flex-col md:flex-row app-height w-full">
        
        <!-- Left Panel: Itinerary Book -->
        <!-- Mobile: Order 2 (Bottom), Height 70% -->
        <div class="order-2 md:order-1 w-full md:w-[45%] flex flex-col h-[70%] md:h-full bg-white shadow-xl z-20 border-r border-gray-200">
            
            <!-- Sticky Header Wrapper (Freeze Top) -->
            <div class="sticky top-0 z-30 bg-white shadow-sm shrink-0">
                
                <!-- Ultra Compact Header -->
                <div class="px-3 py-2 bg-slate-900 text-white flex justify-between items-center shadow-inner">
                    <div class="flex items-center gap-2">
                        <i class="fa-solid fa-plane-departure text-indigo-400 text-sm"></i>
                        <h1 class="text-sm font-bold tracking-wide">2026 È¶ñÁàæË°å</h1>
                    </div>
                    <div class="text-[10px] text-slate-300 bg-slate-800 px-2 py-0.5 rounded-full">
                        06/01-08 (8Â§©)
                    </div>
                </div>

                <!-- Ultra Compact Day Tabs (Height Reduced 50%) -->
                <div id="day-tabs" class="flex overflow-x-auto whitespace-nowrap bg-slate-50 border-b border-slate-200 p-1 shrink-0 no-scrollbar">
                    <button 
                        v-for="(day, index) in schedule" 
                        :key="index"
                        :id="'day-btn-' + index"
                        @click="selectDay(index)"
                        :class="['flex-none px-3 py-1 rounded-md text-xs font-bold mr-1.5 transition-all border', 
                                 currentDayIndex === index ? 'bg-indigo-600 text-white border-indigo-600 shadow-sm' : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-100']"
                    >
                        Day {{ index + 1 }}
                    </button>
                    <div class="w-2 flex-none"></div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto p-3 custom-scrollbar bg-slate-50 relative scroll-smooth" id="timeline-container">
                
                <!-- Day Summary (Scrolls with content now, header is sticky) -->
                <div class="bg-white p-3 rounded-lg shadow-sm border border-slate-200 mb-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h2 class="text-base font-black text-slate-800 leading-tight">{{ currentDay.date.split(' ')[0] }}</h2>
                            <h3 class="text-xs font-bold text-slate-500 mt-0.5">{{ currentDay.title }}</h3>
                        </div>
                        <div class="text-right">
                            <span class="block text-[10px] bg-orange-50 text-orange-700 px-1.5 py-0.5 rounded border border-orange-100 mb-1">Âçà: {{ currentDay.lunch }}</span>
                            <span class="block text-[10px] bg-indigo-50 text-indigo-700 px-1.5 py-0.5 rounded border border-indigo-100">Êôö: {{ currentDay.dinner }}</span>
                        </div>
                    </div>
                    
                    <!-- Special Notice -->
                    <div v-if="currentDay.notice" class="mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-[10px] text-yellow-800 leading-relaxed whitespace-pre-line">
                        <i class="fa-solid fa-triangle-exclamation mr-1"></i><strong>È†àÁü•Ôºö</strong>{{ currentDay.notice }}
                    </div>
                </div>

                <!-- Timeline Events -->
                <div class="space-y-3 pb-16 relative px-1">
                    <!-- Vertical Line -->
                    <div class="absolute left-[15px] top-2 bottom-10 w-0.5 bg-slate-200 -z-0"></div>

                    <div 
                        v-for="(event, eIndex) in currentDay.events" 
                        :key="eIndex"
                        @click="focusEvent(event)"
                        :class="['relative pl-8 transition-all duration-200 group cursor-pointer', 
                                 activeEvent === event ? 'scale-[1.01]' : '']"
                    >
                        <!-- Dot -->
                        <div :class="['absolute left-[8px] top-3.5 w-3.5 h-3.5 rounded-full border-2 border-white shadow z-10', 
                                     getCategoryColor(event.category)]">
                        </div>

                        <!-- Card -->
                        <div :class="['p-3 rounded-lg border shadow-sm transition-colors text-sm bg-white',
                                      activeEvent === event ? 'border-indigo-400 ring-1 ring-indigo-100' : 'border-slate-200 active:bg-slate-50']">
                            
                            <!-- Time & Loc -->
                            <div class="flex justify-between items-center mb-1.5">
                                <span class="font-mono font-bold text-slate-600 bg-slate-100 px-1.5 py-0.5 rounded text-[10px]">{{ event.time }}</span>
                                <i :class="['fa-solid text-slate-400 text-xs', getCategoryIcon(event.category)]"></i>
                            </div>
                            <h4 class="font-bold text-slate-800 text-sm mb-1.5 leading-snug">{{ event.location }}</h4>
                            
                            <!-- Note -->
                            <div v-if="event.note" class="text-slate-600 text-[11px] leading-relaxed note-content border-t border-slate-100 pt-1.5 mt-1" v-html="formatNote(event.note)"></div>

                            <!-- Tags -->
                            <div v-if="event.tags" class="mt-2 flex flex-wrap gap-1">
                                <span v-for="tag in event.tags" :class="['text-[10px] px-1.5 py-0.5 rounded border', getTagStyle(tag)]">
                                    {{ tag }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Right Panel: Map -->
        <!-- Mobile: Order 1 (Top), Height 30% -->
        <div id="map-container" class="order-1 md:order-2 w-full md:w-[55%] bg-slate-200 relative z-10">
            <div id="map" class="w-full h-full outline-none"></div>
            <!-- Legend (Desktop Only to save mobile space) -->
            <div class="absolute bottom-6 right-4 bg-white/95 backdrop-blur p-2 rounded shadow-lg text-[10px] z-[1000] hidden md:block border border-slate-200">
                <div class="font-bold mb-1 text-slate-700">Âúñ‰æã</div>
                <div class="grid grid-cols-2 gap-x-3 gap-y-1">
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-blue-500 mr-1.5"></span>ÊôØÈªû</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-orange-500 mr-1.5"></span>ÁæéÈ£ü</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-purple-500 mr-1.5"></span>Ë≥ºÁâ©</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-green-500 mr-1.5"></span>‰∫§ÈÄö</div>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                // --- Data: ‰∫§ÈÄöÈ¢®Èö™Ê†°Ê≠£ÁµÇÊ•µÁâà ---
                const schedule = ref([
                    {
                        date: "06/01 (‰∏Ä) Day 1",
                        title: "È´òÈõÑ ‚ûî È¶ñÁàæ (ÁßªÂãïÊó•)",
                        lunch: "Ê©ü‰∏ä/Ê©üÂ†¥",
                        dinner: "Â§ñÈÄÅ (ÁçµÂ•áÂπ¥Á≥ï/Ê©ãÊùëÁÇ∏Èõû)",
                        events: [
                            { time: "12:00", location: "ÂÆ∂Ë£°Âá∫Áôº", category: "transport", note: "üïí ÊôÇÈñìÔºöÈ†êË®à 12:00-12:30 Âá∫ÈñÄ (‰øùÁïôÁ∑©Ë°ù)\nÁõÆÊ®ôÔºöÈ´òÈõÑÂ∞èÊ∏ØÊ©üÂ†¥ (KHH)", coords: null },
                            { time: "13:30", location: "ÊäµÈÅîÊ©üÂ†¥ & Ëæ¶ÁêÜÁôªÊ©ü", category: "flight", note: "‚úàÔ∏è Ëà™Áè≠ÔºöÂè∞ÁÅ£ËôéËà™ IT662\n‚ö†Ô∏è Âãï‰ΩúÔºöÊâòÈÅãË°åÊùé„ÄÅÈ†òÁôªÊ©üË≠â„ÄÅÈÅéÂÆâÊ™¢", coords: [22.5768, 120.3478] },
                            { time: "15:15", location: "„ÄêÁôªÊ©üÊôÇÈñì Boarding„Äë", category: "alert", note: "üìç Âãï‰ΩúÔºöÂâçÂæÄÁôªÊ©üÈñÄÊ∫ñÂÇôÊéíÈöä\n‚ö†Ô∏è Ê≠ªÁ∑öÔºöÁôªÊ©üÈñÄÈÄöÂ∏∏Êñº 15:35 ÈóúÈñâÔºåË´ãÂãøÈÅ≤Âà∞", coords: null },
                            { time: "15:55", location: "Ëµ∑È£õ (ÂâçÂæÄÈ¶ñÁàæÈáëÊµ¶)", category: "flight", note: "È†êË®àÈ£õË°åÊôÇÈñìÁ¥Ñ 2Â∞èÊôÇ45ÂàÜ", coords: null },
                            { time: "19:40", location: "ÊäµÈÅîÈáëÊµ¶Ê©üÂ†¥ (GMP)", category: "transport", note: "ÂÖ•Â¢É„ÄÅÊèêÈ†òË°åÊùé", coords: [37.5587, 126.8028] },
                            { time: "20:30", location: "‰∫§ÈÄöÔºöÊ©üÂ†¥ ‚ûî È£ØÂ∫ó", category: "transport", note: "üöï ÊñπÂºèÔºöË®àÁ®ãËªä\nüïí ÊôÇÈñìÔºö‰øÆÊ≠£‰º∞ 45-60 ÂàÜÈêò (Á¥çÂÖ•ÊôöÈñìÂ°ûËªäÈ¢®Èö™)\nüí∞ ËªäË≥áÔºöÁ¥Ñ 25,000 ÈüìÂÖÉËµ∑", coords: [37.5587, 126.8028] },
                            { time: "20:50", location: "„ÄêÈóúÈçµÂãï‰Ωú„ÄëÂè´Â§ñÈÄÅÊ±∫Á≠ñ", category: "alert", note: "A. È†ÜÂà©‰∏äËªäÔºöÂú®Ë®àÁ®ãËªä‰∏äÂè´ (È†ê‰º∞ 21:10 ÊäµÈÅî)\nB. Âª∂Ë™§/Â°ûËªäÔºöÊäµÈÅîÈ£ØÂ∫óÂÜçÂè´ (ÊîπÈªûÊ©ãÊùëÁÇ∏ÈõûÔºåËºÉËÄêÊîæ)", coords: null },
                            { time: "21:10", location: "‰πùÊ®π ROKAUS ÈæçÂ±±", category: "hotel", note: "ÊäµÈÅî Check-in (Â∑≤ÈÅé 15:00 ÂèØÁõ¥Êé•ÂÖ•Êàø)", coords: [37.5293, 126.9654] },
                            { time: "21:30", location: "Â§ßÂª≥ÂèñÈ§êÂêÉÂÆµÂ§ú", category: "food", note: "„ÄêPlan A„ÄëÁçµÂ•áËæ£ÁÇíÂπ¥Á≥ï (ÈúÄ 21:20 Ââç‰∏ãÂñÆ)\n„ÄêPlan B„ÄëÊ©ãÊùëÁÇ∏Èõû (Ëã•Ë∂ï‰∏ç‰∏äÂπ¥Á≥ïÊîπÂêÉÈÄôÂÄã)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/02 (‰∫å) Day 2",
                        title: "Â§¢Á¢≥(SOP)ÔºãÂä†Â±±Outlet(ÂãïÁ∑öÂÑ™Âåñ)",
                        lunch: "Â§¢Á¢≥ (ÁáíËÇâ)",
                        dinner: "Outlet Ëá™ÁêÜ",
                        events: [
                            { time: "10:00", location: "‰∫§ÈÄöÔºöÈ£ØÂ∫ó ‚ûî Â§¢Á¢≥", category: "transport", note: "üìç Âú∞ÂùÄÔºöÈ¶ñÁàæ ÈæçÂ±±ÂçÄ ÁôΩÂá°Ë∑Ø99Ë°ó 50\nüöå Êé®Ëñ¶ÔºöÂÖ¨Ëªä (Á¥Ñ 11 ÂàÜÈêò / ÊúÄÂø´) ‚ûî [‰∏âËßíÂú∞Á´ô] ‰∏ãËªä\nüö∂ ÂÇôÊ°àÔºöÊ≠•Ë°å (Á¥Ñ 23 ÂàÜÈêò / 1.4km / Naver Map È©óË≠â)", coords: [37.5372, 126.9698] },
                            { time: "10:40", location: "Â§¢Á¢≥ÔºöÊäµÈÅîÁèæÂ†¥Ê∫ñÂÇôÂÄô‰Ωç", category: "food", note: "‚ö†Ô∏è Ë¶èÂâáÔºö11:00 ÈñãÊîæÁèæÂ†¥Ê©üÂè∞ÁôªË®ò (‰∏çÂèØÊåáÂÆöÊôÇÈñì/ÁÑ°È†êÁ¥Ñ)\nüìã Âãï‰ΩúÔºö10:40 ÂâçÊäµÈÅî ‚ûî 11:00 Ê∫ñÊôÇÊìç‰ΩúÊ©üÂè∞\nüõë È¢®Èö™ÊéßÁÆ°ÔºöËã•ÈúÄÁ≠â 3hr+ÔºåÁõ¥Êé•ÂïüÂãïÂÇôÊ°àÂçàÈ§ê", tags: ["ÊéíÈöäÈóúÈçµ"], coords: [37.5372, 126.9698] },
                            { time: "‰∏äÂçà", location: "ÈôÑËøëÂíñÂï°Âª≥Á≠âÂæÖ", category: "food", note: "Â¶Ç: Approach Coffee", coords: [37.5288, 126.9715] },
                            { time: "12:00", location: "ÂçàÈ§êÔºöÂ§¢Á¢≥ (ÁáíËÇâ)", category: "food", note: "üïí ÁáüÊ•≠Ôºö12:00 ÈñãÂßãÂè´ËôüÂÖ•Â∫ß\nüïí È†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 1.5 - 2 Â∞èÊôÇ", coords: [37.5372, 126.9698] },
                            { time: "14:30", location: "„ÄêÁ©∫Á™óÊúüÊ±∫Á≠ñÔºö14:30-16:00„Äë", category: "alert", note: "üí° ÈÅ∏È†Ö A (Âë≥ÈÅìÈáç/ÈúÄË£úÂ¶ù)ÔºöÂõûÈ£ØÂ∫ó (15:30 ÂøÖÈ†àÂá∫Áôº)\nüí° ÈÅ∏È†Ö B (Á≤æÁ•û‰Ω≥)ÔºöAmore Pacific Á∏ΩÈÉ® (15:40 ÂøÖÈ†àÈõ¢Èñã)\nüí° ÈÅ∏È†Ö C (‰∫∫ÊΩÆÁÑ¶ÊÖÆ)ÔºöÁõ¥Êé•ÊèêÊó©Âéª Outlet (Êà∞ÂäõÊúÄÂº∑Âåñ)", coords: [37.5293, 126.9654] },
                            { time: "16:00", location: "‰∫§ÈÄöÔºöÈæçÂ±± ‚ûî Âä†Â±±Êï∏Á¢ºÂúíÂçÄ", category: "transport", note: "üöá Âú∞ÈêµÔºö1ËôüÁ∑ö [ÈæçÂ±±] ‚ûî [Âä†Â±±Êï∏Á¢ºÂúíÂçÄ] (ÂæÄ‰ªÅÂ∑ù/Ê∞¥ÂéüÊñπÂêë)\nüïí ÊôÇÈñìÔºöÂÖ®Á®ãÁ¥Ñ 35-40 ÂàÜÈêò (Âê´Ê≠•Ë°åËàáÂÄôËªä)", coords: [37.4815, 126.8826] },
                            { time: "16:40", location: "Mario Outlet (1/2/3È§®)", category: "shopping", note: "‚ö†Ô∏è ÈÄ≤Â†¥ SOPÔºö1.ÂÖàÊãçÊ®ìÂ±§Â∞éË¶Ω 2.ÈéñÂÆöÁõÆÊ®ôÂìÅÁâåÊ®ìÂ±§\n‚ù∂ [16:40-17:50] 2È§® (Leisure)ÔºöÂÖàÊîªÊ©üËÉΩ (North Face, K2)\n‚ù∑ [17:50-19:20] 3È§® (Mario Mall)ÔºöÂÜçÊîªÊΩÆÊµÅ (MLB, Discovery)\n‚ù∏ [19:20-20:00] Ê±∫Á≠ñËàáË§áÈ©ó\n‚ùπ [20:00-20:30] ÊôöÈ§ê (3È§®ÁæéÈ£üË°ó)", tags: ["Êà∞ÂäõÂÖ®Èñã"], coords: [37.4784, 126.8887] },
                            { time: "20:30", location: "‰∫§ÈÄöÔºöÂä†Â±± ‚ûî ÈæçÂ±±", category: "transport", note: "üöá Âú∞ÈêµÔºö1ËôüÁ∑öÁõ¥ÈÅî [ÈæçÂ±±Á´ô] (Á¥Ñ 35-40 ÂàÜÈêò)", coords: [37.5293, 126.9654] },
                            { time: "21:15", location: "ÊäµÈÅîÈ£ØÂ∫ó", category: "hotel", note: "Êï¥ÁêÜÂ§ßÈáèÊà∞Âà©ÂìÅ", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/03 (‰∏â) Day 3",
                        title: "ÈæçÁêÜÂúòË∑ØÔºãÁãéÈ∑ó‰∫≠ÔºãÊº¢ÂçóÊ¥û",
                        lunch: "ÈæçÁêÜÂúòË∑ØÊó©ÂçàÈ§ê",
                        dinner: "Êº¢ÂçóÊ¥û 24H È¶¨Èà¥ËñØÊπØ",
                        events: [
                            { time: "09:30", location: "‰∫§ÈÄöÔºöÈ£ØÂ∫ó ‚ûî ÈæçÁêÜÂúòË∑Ø", category: "transport", note: "üí° Á≠ñÁï•ÔºöÂêçÂ∫ó‰ΩçÊñº„Äå‰∏âËßíÂú∞Á´ô„ÄçÔºåÂª∫Ë≠∞Êê≠Ëªä\nüöá Âú∞ÈêµÔºö4ËôüÁ∑ö [Êñ∞ÈæçÂ±±] ‚ûî [‰∏âËßíÂú∞] (Êê≠1Á´ô)\nüöå ÂÖ¨ËªäÔºöËóçËâ≤Â∑¥Â£´ 100/150 Á≠â (Êê≠2Á´ô)", coords: [37.5312, 126.9705] },
                            { time: "‰∏äÂçà", location: "Êó©ÂçàÈ§êÂêçÂ∫ó„Äê‰∏âÈÅ∏‰∏Ä„Äë", category: "food", note: "‚ù∂ Dotori (Ê©°ÂØ¶)ÔºöÁâπËâ≤ÂÑ™Ê†º (Ê≠•Ë°åÁ¥Ñ 20-23 ÂàÜÈêò / 1.1km)\n‚ù∑ SAM SAM SAMÔºöÁæéÂºèÂæ©Âè§ÂÆ∂Â∏∏Ëèú (Ê≠•Ë°åÁ¥Ñ 20 ÂàÜÈêò / 1.0km)\n‚ù∏ Teddy Beurre HouseÔºöÊ≥ïÂºèÂèØÈ†å (Ê≠•Ë°åÁ¥Ñ 16-18 ÂàÜÈêò / 0.9km)", coords: [37.5312, 126.9705] },
                            { time: "12:00", location: "‰∫§ÈÄöÔºöÈæçÁêÜÂúòË∑Ø ‚ûî ÁãéÈ∑ó‰∫≠", category: "transport", note: "üöï Âª∫Ë≠∞ÔºöË®àÁ®ãËªä (Ë∑®ÂçÄÊúÄÂø´)\nüïí ÊôÇÈñìÔºö‰øÆÊ≠£‰º∞ 25-35 ÂàÜÈêò (Ë¶ñÊº¢ÂçóÂ§ßÊ©ãË∑ØÊ≥Å)\nüí≥ ÂÇôÊ°àÔºöÂú∞ÈêµËΩâ‰πòÁ¥Ñ 40 ÂàÜÈêò", coords: [37.5273, 127.0392] },
                            { time: "‰∏ãÂçà", location: "ÁãéÈ∑ó‰∫≠ / ÁæÖÂæ∑Â•ß", category: "shopping", note: "Â≥∂Â±±ÂÖ¨ÂúíÂë®ÈÇäÔºöÈÄõÁ≤æÂìÅËàáÊΩÆÁâå\nÈ†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 3.5 - 4 Â∞èÊôÇ", coords: [37.5273, 127.0392] },
                            { time: "16:00", location: "‰∫§ÈÄöÔºöÁãéÈ∑ó‰∫≠ ‚ûî Êº¢ÂçóÊ¥û", category: "transport", note: "üí≥ Ê∞£ÂÄôÂç°ÔºöÂ∑¥Â£´ 142 / 144 / 472 (È†ÜÂêëÂõûÁ®ã)\nüïí ÊôÇÈñìÔºöÂÖ¨ËªäÁ¥Ñ 15-20 ÂàÜÈêò + Ê≠•Ë°å", coords: [37.5348, 127.0012] },
                            { time: "‰∏ãÂçà", location: "Êº¢ÂçóÊ¥ûÈÄõË°ó", category: "shopping", note: "Â∞àÊîªË®≠Ë®àÂ∏´ÊΩÆÁâå (Mardi, MaritheÁ≠â)\nÈ†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 3 Â∞èÊôÇ", coords: [37.5348, 127.0012] },
                            { time: "19:30", location: "Ê≠•Ë°åÂâçÂæÄÊôöÈ§ê", category: "transport", note: "ÂâçÂæÄÊº¢ÂçóÊ¥û 24Â∞èÊôÇÈ¶¨Èà¥ËñØÊéíÈ™®ÊπØ", coords: [37.5332, 127.0028] },
                            { time: "20:00", location: "ÊôöÈ§êÔºöÈ¶¨Èà¥ËñØÊéíÈ™®ÊπØ", category: "food", note: "Êº¢ÂçóÊ¥û 24Â∞èÊôÇÁáüÊ•≠ÂêçÂ∫ó", coords: [37.5332, 127.0028] },
                            { time: "21:30", location: "‰∫§ÈÄöÔºöÊº¢ÂçóÊ¥û ‚ûî È£ØÂ∫ó", category: "transport", note: "üí≥ Ê∞£ÂÄôÂç°ÔºöÂ∑¥Â£´ 400 / 110B (Áõ¥ÈÅîÈ£ØÂ∫óÈôÑËøë)\nüïí ÊôÇÈñìÔºöÂÖ¨ËªäÁ¥Ñ 20 ÂàÜÈêò", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/04 (Âõõ) Day 4",
                        title: "Êò•Â∑ù‰∏ÄÊó•ÈÅä (ÁâßÂ†¥ÔºãÈêµÈÅì)",
                        lunch: "ÊòéÊ¥ûËæ£ÁÇíÈõûÊéí",
                        dinner: "ËªäÁ´ôËá™ÁêÜ",
                        notice: "1. [ÁÅ´Ëªä] 5/4 07:00 Êê∂ ITX (Âéª09:17/Âõû18:56)\n2. [È†êÁ¥Ñ] Êò•Â∑ùÂ§ñÂúã‰∫∫ËßÄÂÖâË®àÁ®ãËªä\n3. [È†êÁ¥Ñ] Ê±üÊùëÈêµË∑ØËá™Ë°åËªä 16:30Â†¥\n4. [ÁèæÈáë] Ê∫ñÂÇô 8Ëê¨ÈüìÂÖÉ‰ªòË®àÁ®ãËªä\n5. [Ë≠â‰ª∂] ÂãôÂøÖÂ∏∂Ë≠∑ÁÖß",
                        events: [
                            { time: "09:17", location: "ÈæçÂ±±Á´ô (Yongsan)", category: "transport", note: "üöÑ Êê≠‰πò ITX-ÈùíÊò•ËôüÂá∫Áôº (Âª∫Ë≠∞Ëªä‰∏äÂêÉÊó©È§ê)", coords: [37.5298, 126.9647] },
                            { time: "10:40", location: "ÊäµÈÅîÊò•Â∑ùÁ´ô", category: "activity", note: "üìç Âãï‰ΩúÔºöÂâçÂæÄ 1 ËôüÂá∫Âè£„ÄåTravel Island„ÄçÊ´ÉÊ™Ø\nüìã ‰ªªÂãôÔºöÂá∫Á§∫Ë≠∑ÁÖß„ÄÅÊ†∏Â∞çÈ†êÁ¥ÑË≥áÊñô", coords: [37.8844, 127.7171] },
                            { time: "11:00", location: "Ë®àÁ®ãËªäÂåÖËªäÂïüÂãï", category: "transport", note: "üöï Êåá‰ª§ÔºöÊ∫ñÊôÇ‰∏äËªä (ÁõÆÊ®ô 5hr / È†êÁÆó 7Ëê¨ÈüìÂÖÉ)", coords: [37.8844, 127.7171] },
                            { time: "11:40", location: "Âπ∏Á¶èËçâÂéüÁâßÂ†¥", category: "activity", note: "üïí ÂÅúÁïôÔºö1.5 Â∞èÊôÇ (Áà¨Âù°ÊãçÁµïÊôØ„ÄÅÈ§µÁ∂øÁæä)", coords: [37.9472, 127.6703] },
                            { time: "13:35", location: "ÂúüË±ÜÈ∫µÂåÖ", category: "food", note: "ü•° Êåá‰ª§ÔºöÂ§ñÂ∏∂Ê®°Âºè (Takeout Only)\n‚ö†Ô∏è ÈáçÈªûÔºöÂè™ÊãçÁÖßÔºãË≤∑È∫µÂåÖÂ§ñÂ∏∂Ôºå‰∏çÂÖßÁî® (ÁúÅÊôÇÈóúÈçµ)", coords: [37.9255, 127.7812] },
                            { time: "14:20", location: "ÊòéÊ¥ûËæ£ÁÇíÈõûÊéíË°ó", category: "food", note: "üïí ÂÅúÁïôÔºö1 Â∞èÊôÇ\n‚ö†Ô∏è Ê≠ªÁ∑ö (GATE)Ôºö15:25 ÂøÖÈ†à‰∏äËªäÈõ¢Èñã", coords: [37.8797, 127.7283] },
                            { time: "15:45", location: "ÊäµÈÅîÈáëË£ïË≤ûÁ´ô", category: "transport", note: "üõë Ë®àÁ®ãËªä‰ªªÂãôÁµêÊùü\nüí∞ ‰ªòÊ¨æÔºöÊîØ‰ªòÁèæÈáëÁ¥Ñ 70,000 ÈüìÂÖÉÁµ¶Âè∏Ê©ü", coords: [37.8164, 127.7135] },
                            { time: "15:45", location: "Â†±Âà∞Á∑©Ë°ù", category: "alert", note: "üöª Âãï‰ΩúÔºö‰∏äÂªÅÊâÄ„ÄÅÊèõÂØ¶È´îÁ•®„ÄÅ16:10 ÂâçÊäµÈÅîÈõÜÂêà", coords: [37.8164, 127.7135] },
                            { time: "16:30", location: "Ê±üÊùëÈêµË∑ØËá™Ë°åËªä", category: "activity", note: "üïí È´îÈ©óÔºöÁ¥Ñ 1.5 Â∞èÊôÇ (È®éË°å50ÂàÜ+ÁÅ´Ëªä20ÂàÜ+Êé•ÈßÅËªä)", coords: [37.8164, 127.7135] },
                            { time: "18:15", location: "Âú∞ÈêµÁßªÂãï", category: "transport", note: "üöá Êê≠‰πò‰∫¨Êò•Á∑öÂú∞Èêµ (ÂæÄÊò•Â∑ùÊñπÂêë) Âùê 1 Á´ô", coords: [37.8164, 127.7135] },
                            { time: "18:25", location: "ÂçóÊò•Â∑ùÁ´ô (Namchuncheon)", category: "transport", note: "‚òï Âá∫Á´ô‰ºëÊÅØ„ÄÅË≤∑Èõ∂È£üÂÄôËªä", coords: [37.8638, 127.7239] },
                            { time: "18:56", location: "ÂõûÁ®ãÈ¶ñÁàæ (ITX)", category: "transport", note: "üöÑ „ÄêPlan A„ÄëÂçóÊò•Â∑ù 18:56 Áôº ‚ûî 20:11 ÊäµÈÅîÈæçÂ±±\nüöÑ „ÄêPlan B„ÄëÂçóÊò•Â∑ù 19:56 Áôº ‚ûî 21:14 ÊäµÈÅîÈæçÂ±±", coords: [37.5298, 126.9647] }
                        ]
                    },
                    {
                        date: "06/05 (‰∫î) Day 5",
                        title: "ÈÜ´Áæé(3.5h)ÔºãËÅñÊ∞¥Ê¥û(5h)",
                        lunch: "ÁÉ§Èª® (ËÅñÊ∞¥Â∫ó)",
                        dinner: "ËÅñÊ∞¥È¶¨Èà¥ËñØÊéíÈ™®ÊπØ",
                        events: [
                            { time: "10:15", location: "‰∫§ÈÄöÔºöÈæçÂ±± ‚ûî ËàçÂ†Ç", category: "transport", note: "üí≥ Ê∞£ÂÄôÂç°ÔºöÂú∞Èêµ 4ËôüÁ∑ö [Êñ∞ÈæçÂ±±] ‚ûî [ËàçÂ†Ç]\nüïí ÊôÇÈñìÔºöÁ¥Ñ 20 ÂàÜÈêò", coords: [37.4765, 126.9816] },
                            { time: "11:00", location: "ËàçÂ†ÇÈÜ´ÁæéÁôÇÁ®ã", category: "activity", note: "üïí È†ê‰º∞ÂÅúÁïôÔºö3 ~ 3.5 Â∞èÊôÇ (Âê´Ë´ÆË©¢/È∫ªÈÜâ/ÊñΩ‰Ωú/‰øÆÂæ©)", coords: [37.4765, 126.9816] },
                            { time: "14:40", location: "‰∫§ÈÄöÔºöËàçÂ†Ç ‚ûî ËÅñÊ∞¥", category: "transport", note: "üí≥ Âú∞Èêµ 2ËôüÁ∑ö [ËàçÂ†Ç] ‚ûî [ËÅñÊ∞¥]\nüïí ÊôÇÈñìÔºöÁ¥Ñ 40 ÂàÜÈêò\n*ÈÄ±‰∫î‰∏ãÂçàÂøÖÂ°ûËªäÔºåÂº∑ÁÉàÂª∫Ë≠∞Êê≠Âú∞Èêµ", coords: [37.5445, 127.0560] },
                            { time: "15:20", location: "ÂçàÊôöÈ§êÔºöÁÉ§Èª® (ËÅñÊ∞¥Â∫ó)", category: "food", note: "‚ö†Ô∏è ÊèêÈÜíÔºöÁ∂≤Á¥ÖÂêçÂ∫óÔºåÈúÄÂÄô‰Ωç\n*Á≠ñÁï•ÔºöÂÖàÂéªÁôªË®òÂÄô‰Ωç (Catchtable)ÔºåËã•ÈúÄ‰πÖÂÄôÂâáÂÖàÈÄõË°ó", coords: [37.5428, 127.0543] },
                            { time: "‰∏ãÂçà", location: "ËÅñÊ∞¥Ê¥ûÈÄõË°ó", category: "shopping", note: "È†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 4 - 5 Â∞èÊôÇ", coords: [37.5445, 127.0560] },
                            { time: "ÊôöÈ§ê", location: "ËÅñÊ∞¥È¶¨Èà¥ËñØÊéíÈ™®ÊπØ", category: "food", note: "Êàñ ÂíñÂï°Âª≥ÁîúÈªû", coords: [37.5445, 127.0560] },
                            { time: "20:30", location: "‰∫§ÈÄöÔºöËÅñÊ∞¥ ‚ûî È£ØÂ∫ó", category: "transport", note: "üöï Âª∫Ë≠∞ÔºöË®àÁ®ãËªä (Ë°ìÂæåÂª∫Ë≠∞ËàíÈÅ©ÁßªÂãï)\nüïí ÊôÇÈñìÔºö‰øÆÊ≠£‰º∞ 45-50 ÂàÜÈêò (ÈÄ±‰∫îÊôöÈñìÂ°ûËªäÈ¢®Èö™)\nüí≥ ÂÇôÊ°àÔºöÂú∞ÈêµËΩâ‰πòÁ¥Ñ 45 ÂàÜÈêò (ËºÉÁ¥Ø)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/06 (ÂÖ≠) Day 6",
                        title: "ÁõäÂñÑÊ¥ûÔºãÊñ∞ÁæÖÂÖçÁ®Ö",
                        lunch: "ÁõäÂñÑÁø†Èüø / ÁÑ°ÊãõÁâåÂ∫ó",
                        dinner: "ÈõûÊûóÈ£üÂ†Ç (ÂÇôÊ°à:‰πôÊîØÁ≤æËÇâ)",
                        events: [
                            { time: "09:00", location: "Catchtable ÂèñËôü", category: "alert", note: "ÈÅ†Á´ØÂèñËôüÔºöArtist Bakery", coords: null },
                            { time: "10:00", location: "‰∫§ÈÄöÔºöÈæçÂ±± ‚ûî ÂÆâÂúã", category: "transport", note: "üí≥ Âú∞Èêµ 4ËôüÁ∑öËΩâ 3ËôüÁ∑ö [ÂÆâÂúãÁ´ô]\nüïí ÊôÇÈñìÔºöÁ¥Ñ 25 ÂàÜÈêò (ÂÅáÊó•Âú∞ÈêµÊúÄÁ©©)", coords: [37.5766, 126.9854] },
                            { time: "10:30", location: "Artist Bakery", category: "food", note: "ÈπΩÈ∫µÂåÖÂ§ñÂ∏∂/ÈªûÂøÉ\nË≤∑ÂÆåÂæåÂèØÂú®ÂÆâÂúãÁ´ôÂë®ÈÇäÁ®ç‰Ωú‰ºëÊÅØ", coords: [37.5768, 126.9850] },
                            { time: "12:00", location: "ÂçàÈ§êÔºöÁæ©ÂºèÊñôÁêÜ„Äê‰∫åÈÅ∏‰∏Ä„Äë", category: "food", note: "‚ù∂ Ikseon Chwihyang (ÁõäÂñÑÁø†Èüø)\n‚ù∑ Ganpan Eopneun Gage (ÁÑ°ÊãõÁâåÂ∫ó)", coords: [37.5744, 126.9905] },
                            { time: "13:30", location: "ÁõäÂñÑÊ¥ûÈüìÂ±ãÊùë", category: "activity", note: "Ê∞õÂúçÂíñÂï°Âª≥/ÊñáÂâµÂ∞èÁâ©\n‚òï Êé®Ëñ¶ÔºöÊ∏ÖÊ∞¥Â†Ç / Ê®ÇÂúíÈ©õ", coords: [37.5744, 126.9905] },
                            { time: "15:15", location: "‰∫§ÈÄöÔºöÁõäÂñÑÊ¥û ‚ûî Êñ∞ÁæÖÂÖçÁ®Ö", category: "transport", note: "üöï Âº∑ÁÉàÂª∫Ë≠∞ÔºöË®àÁ®ãËªä (ÁúÅÂäõ‰∏îÂø´ÈÄü)\nüïí ÊôÇÈñìÔºö‰øÆÊ≠£‰º∞ 20-25 ÂàÜÈêò (ÂÅáÊó•Â∏ÇÂçÄËªäÂ§ö)", coords: [37.5562, 127.0084] },
                            { time: "15:40", location: "Êñ∞ÁæÖÂÖçÁ®ÖÂ∫ó È¶ñÁàæÂ∫ó", category: "shopping", note: "üïí È†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 2 Â∞èÊôÇ (Âê´Ëæ¶Âç°„ÄÅË©¶Ëâ≤„ÄÅÁµêÂ∏≥)", coords: [37.5562, 127.0084] },
                            { time: "17:40", location: "‰∫§ÈÄöÔºöÂÖçÁ®ÖÂ∫ó ‚ûî ÈêòË∑Ø3Ë°ó", category: "transport", note: "üöï Âª∫Ë≠∞ÔºöË®àÁ®ãËªä (Á¥Ñ 15-20 ÂàÜÈêò)", coords: [37.5714, 126.9915] },
                            { time: "18:00", location: "ÊôöÈ§êÔºöÈõûÊûóÈ£üÂ†Ç Êú¨Â∫ó", category: "food", note: "üìç ‰ΩçÁΩÆÔºöÈêòË∑Ø3Ë°óÁ´ô 12 ËôüÂá∫Âè£ÈôÑËøë\nüí° „ÄêÂÇôÊ°à Plan B„Äë‰πôÊîØÁ≤æËÇâ (Ê≠•Ë°å 5-8 ÂàÜÈêò)", coords: [37.5714, 126.9915] },
                            { time: "20:00", location: "‰∫§ÈÄöÔºöÈêòË∑Ø3Ë°ó ‚ûî È£ØÂ∫ó", category: "transport", note: "üí≥ Âú∞Èêµ 1ËôüÁ∑öÁõ¥ÈÅî [ÈæçÂ±±Á´ô]", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/07 (Êó•) Day 7",
                        title: "Ââ™È´ÆÔºãÊúõÈÅ†ÔºãÂºòÂ§ßÔºãÊñ∞Êùë",
                        lunch: "ÊúõÈÅ†Â∏ÇÂ†¥Â∞èÂêÉ",
                        dinner: "Êñ∞Êùë Â•∂Ëæ£ÁáâÊéíÈ™®",
                        events: [
                            { time: "10:20", location: "‰∫§ÈÄöÔºöÈæçÂ±± ‚ûî Âêà‰∫ï", category: "transport", note: "üí≥ Âú∞Èêµ 4ËôüÁ∑öËΩâ 6ËôüÁ∑ö [Âêà‰∫ïÁ´ô]\nüïí ÊôÇÈñìÔºöÁ¥Ñ 20-25 ÂàÜÈêò (ËΩâ‰πòÊúÄÁúÅÂäõ)\nüöï ÂÇôÊ°àÔºöË®àÁ®ãËªäÁ¥Ñ 15-20 ÂàÜÈêò", coords: [37.5488, 126.9133] },
                            { time: "11:00", location: "Âêà‰∫ïÁ´ôÈ´ÆÂªä", category: "activity", note: "üïí È†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 4 Â∞èÊôÇ (Ââ™+Êüì/Ááô)", coords: [37.5488, 126.9133] },
                            { time: "15:00", location: "‰∫§ÈÄöÔºöÂêà‰∫ï ‚ûî ÊúõÈÅ†", category: "transport", note: "üí≥ Âú∞Èêµ 6ËôüÁ∑ö (ÂÉÖ 1 Á´ô)", coords: [37.5561, 126.9064] },
                            { time: "15:20", location: "ÊúõÈÅ†Â∏ÇÂ†¥", category: "food", note: "ÂêÉÈõ®ËÄ≥Ê®ÇÁÇ∏Ëæ£Ê§í„ÄÅÂèØÊ®ÇÈ§Ö\nÂÅúÁïôÁ¥Ñ 1.5 Â∞èÊôÇ", coords: [37.5561, 126.9064] },
                            { time: "16:40", location: "‰∫§ÈÄöÔºöÊúõÈÅ† ‚ûî ÂºòÂ§ß", category: "transport", note: "üí≥ Âú∞Èêµ 6ËôüÁ∑öËΩâ 2ËôüÁ∑ö", coords: [37.5575, 126.9245] },
                            { time: "17:00", location: "ÂºòÂ§ßÂÖ•Âè£Á´ô 8 ËôüÂá∫Âè£", category: "shopping", note: "Ëó•Â±Ä/ÁæéÂ¶ù Âø´ÈÄüË£úË≤®", coords: [37.5575, 126.9245] },
                            { time: "19:00", location: "‰∫§ÈÄöÔºöÂºòÂ§ß ‚ûî Êñ∞Êùë", category: "transport", note: "üö∂ Ê≠•Ë°åÔºöÊ≤ø‰∫¨Áæ©Á∑öÊõ∏Ë°óÊï£Ê≠•Á¥Ñ 15-20 ÂàÜÈêò", coords: [37.5551, 126.9369] },
                            { time: "19:30", location: "ÊôöÈ§êÔºöÊñ∞Êùë Â•∂Ëæ£ÁáâÊéíÈ™®", category: "food", note: "È†ê‰º∞ÂÅúÁïôÔºöÁ¥Ñ 1.5 Â∞èÊôÇ", coords: [37.5551, 126.9369] },
                            { time: "21:00", location: "‰∫§ÈÄöÔºöÊñ∞Êùë ‚ûî È£ØÂ∫ó", category: "transport", note: "üí° Á≠ñÁï•ÔºöÈÄ±Êó•ÊôöÈñìÂºòÂ§ß/Êñ∞ÊùëÂçÄÊòìÂ°ûËªäÔºåÂª∫Ë≠∞ÂÑ™ÂÖàÊê≠Âú∞Èêµ\nüöá Âú∞ÈêµÔºö2ËôüÁ∑öËΩâ 1ËôüÁ∑ö (ÂÖ®Á®ãÁ¥Ñ 25-30 ÂàÜÈêòÔºåÊúÄÁ©©)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/08 (‰∏Ä) Day 8",
                        title: "ÈÄÄÊàøÁ©∫Ê™î(4h)ÔºãÊ©üÂ†¥Â†±Âà∞",
                        lunch: "I-Park Mall/Ë∂ÖÂ∏Ç",
                        dinner: "Ê©ü‰∏ä/Ê©üÂ†¥",
                        events: [
                            { time: "10:00", location: "Êï¥ÁêÜË°åÊùé & Ê∫ñÂÇô Check-out", category: "hotel", note: "", coords: [37.5293, 126.9654] },
                            { time: "11:00", location: "Ëæ¶ÁêÜÈÄÄÊàø", category: "hotel", note: "üß≥ Âãï‰ΩúÔºöÂ∞áË°åÊùéÂØÑÊîæÂú®È£ØÂ∫óÊ´ÉÂè∞", coords: [37.5293, 126.9654] },
                            { time: "11:15", location: "„ÄêÁ©∫Á™óÊúüÔºö11:15-16:30„Äë", category: "shopping", note: "ÊúÄÂæåÊéÉË≤® (Á¥Ñ 4-5 Â∞èÊôÇ)\nüí° Âª∫Ë≠∞ AÔºöEmart ÈæçÂ±±Â∫ó\nüí° Âª∫Ë≠∞ BÔºöiPark Mall", coords: [37.5286, 126.9640] },
                            { time: "16:30", location: "ÂõûÂà∞È£ØÂ∫óÈ†òÂèñË°åÊùé", category: "hotel", note: "", coords: [37.5293, 126.9654] },
                            { time: "17:00", location: "‰∫§ÈÄöÔºöÈ£ØÂ∫ó ‚ûî ÈáëÊµ¶Ê©üÂ†¥", category: "transport", note: "üöï Âª∫Ë≠∞ÔºöË®àÁ®ãËªä (ÂãôÂøÖÈ†êÁïôÂ°ûËªäÁ∑©Ë°ù)\nüïí ÊôÇÈñìÔºö‰øÆÊ≠£‰º∞ 50-60 ÂàÜÈêò (‰∏ãÁè≠Â∞ñÂ≥∞ÊôÇÊÆµÈ¢®Èö™)\nüí∞ ËªäË≥áÔºöÁ¥Ñ 25,000-30,000 ÈüìÂÖÉ", coords: [37.5587, 126.8028] },
                            { time: "17:50", location: "ÊäµÈÅîÈáëÊµ¶Ê©üÂ†¥ & Â†±Âà∞", category: "flight", note: "1. Ë®óÈÅãË°åÊùé (Check-in)\n2. Ëæ¶ÁêÜÈÄÄÁ®ÖÔºö2Ê®ìÊµ∑ÈóúËìãÁ´† -> 3Ê®ìÈÄÄÁ®ÖÊ´ÉÂè∞", coords: [37.5587, 126.8028] },
                            { time: "18:30", location: "ÈÄöÈÅéÂÆâÊ™¢ & Ë≠âÁÖßÊü•È©ó", category: "alert", note: "È†ê‰º∞ 20-30 ÂàÜÈêò", coords: null },
                            { time: "19:00", location: "È†òÂèñÂÖçÁ®ÖÂìÅ & ÈÄÄÁ®ÖÈáë", category: "shopping", note: "üìç ‰ΩçÁΩÆÔºöÈÄöÈÅéÂÆâÊ™¢Âæå 3Ê®ì 34ËôüÁôªÊ©üÈñÄÈôÑËøë\n‚ö†Ô∏è Ë®ªÔºöÊâÄÊúâÂÖçÁ®ÖÂ∫óÁöÜÂú®Âêå‰∏ÄËôïÊèêË≤®", coords: null },
                            { time: "19:55", location: "„ÄêÁôªÊ©üÊôÇÈñì Boarding„Äë", category: "alert", note: "Ëµ∑È£õÂâç 40 ÂàÜÈêò\n‚ö†Ô∏è ÊèêÈÜíÔºöË´ãÁ¢∫‰øùÂ∑≤È†òÂÆåÂÖçÁ®ÖÂìÅÔºåÈÅøÂÖçÂ£ìÁ∑ö", coords: null },
                            { time: "20:35", location: "Ëµ∑È£õËøîÁ®ã (ÂõûÈ´òÈõÑ)", category: "flight", note: "‚úàÔ∏è Âè∞ÁÅ£ËôéËà™ IT663", coords: null },
                            { time: "22:40", location: "ÊäµÈÅîÈ´òÈõÑÂ∞èÊ∏ØÊ©üÂ†¥", category: "transport", note: "Âπ≥ÂÆâÂõûÂÆ∂", coords: [22.5768, 120.3478] }
                        ]
                    }
                ]);

                // --- Logic & Map ---
                const currentDayIndex = ref(0);
                const currentDay = ref(schedule.value[0]);
                const activeEvent = ref(null);
                let map = null;
                let markers = [];

                const formatNote = (text) => {
                    // Highlight warnings
                    return text.replace(/(‚ö†Ô∏è|üõë|„Äê|„Äë)/g, '<span class="text-orange-600 font-bold">$1</span>');
                };

                const getCategoryColor = (cat) => {
                    const map = { activity: 'bg-blue-500 border-blue-200', food: 'bg-orange-500 border-orange-200', shopping: 'bg-purple-500 border-purple-200', transport: 'bg-green-500 border-green-200', hotel: 'bg-gray-600 border-gray-300', flight: 'bg-sky-500 border-sky-200', alert: 'bg-red-500 border-red-200' };
                    return map[cat] || 'bg-gray-400';
                };

                const getCategoryIcon = (cat) => {
                    const map = { activity: 'fa-camera', food: 'fa-utensils', shopping: 'fa-bag-shopping', transport: 'fa-train-subway', hotel: 'fa-bed', flight: 'fa-plane', alert: 'fa-circle-exclamation' };
                    return map[cat] || 'fa-location-dot';
                };

                const getTagStyle = (tag) => {
                    if (tag.includes("È¢®Èö™") || tag.includes("Ê≠ªÁ∑ö")) return 'bg-red-100 text-red-700 border-red-200';
                    return 'bg-slate-100 text-slate-600 border-slate-200';
                };

                // Initialize Map
                const initMap = () => {
                    map = L.map('map', { zoomControl: false, padding: [20, 20] }).setView([37.5665, 126.9780], 13);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                        attribution: '&copy; OpenStreetMap &copy; CARTO', maxZoom: 20
                    }).addTo(map);
                    L.control.zoom({ position: 'topright' }).addTo(map);
                    renderMarkers();
                };

                // Render Markers
                const renderMarkers = () => {
                    markers.forEach(m => map.removeLayer(m));
                    markers = [];
                    const bounds = L.latLngBounds();
                    let hasCoords = false;

                    currentDay.value.events.forEach((event) => {
                        if (event.coords) {
                            hasCoords = true;
                            // Create Custom Icon
                            const iconHtml = `<div class="flex items-center justify-center w-full h-full text-white text-xs rounded-full shadow-lg ${getCategoryColor(event.category).split(' ')[0]}"><i class="${getCategoryIcon(event.category)}"></i></div>`;
                            const icon = L.divIcon({
                                className: 'custom-marker',
                                html: iconHtml,
                                iconSize: [28, 28],
                                iconAnchor: [14, 14],
                                popupAnchor: [0, -14]
                            });

                            const marker = L.marker(event.coords, { icon: icon }).addTo(map);
                            marker.bindPopup(`<div class="text-center font-bold text-slate-800">${event.location}</div>`, { closeButton: false });
                            
                            marker.on('click', () => focusEvent(event));
                            
                            marker.eventData = event;
                            markers.push(marker);
                            bounds.extend(event.coords);
                        }
                    });

                    if (hasCoords) map.fitBounds(bounds, { padding: [50, 50], maxZoom: 15 });
                };

                // Actions
                const selectDay = (index) => {
                    currentDayIndex.value = index;
                    currentDay.value = schedule.value[index];
                    activeEvent.value = null;
                    document.getElementById('timeline-container').scrollTop = 0;
                    
                    nextTick(() => {
                        // Scroll tab into view
                        const btn = document.getElementById('day-btn-' + index);
                        if (btn) btn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                        renderMarkers();
                    });
                };

                const focusEvent = (event) => {
                    activeEvent.value = event;
                    if (event.coords && map) {
                        map.flyTo(event.coords, 16, { animate: true, duration: 1 });
                        markers.forEach(m => {
                            if (m.eventData === event) m.openPopup();
                            else m.closePopup();
                        });
                    }
                };

                onMounted(() => initMap());

                return { schedule, currentDay, currentDayIndex, activeEvent, selectDay, focusEvent, getCategoryColor, getCategoryIcon, getTagStyle, formatNote };
            }
        }).mount('#app');
    </script>
</body>
</html>
