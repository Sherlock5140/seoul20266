<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 é¦–çˆ¾ 8 å¤© 7 å¤œï½œäº¤é€šé¢¨éšªæ ¡æ­£çµ‚æ¥µç‰ˆ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        .app-height { height: 100dvh; }
        
        /* Mobile Layout Adjustment: Map smaller (30%), List taller (70%) */
        #map-container { height: 30%; } 
        @media (min-width: 768px) {
            #map-container { height: 100%; }
            .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        }

        /* Markdown-like note styling */
        .note-content { white-space: pre-wrap; word-break: break-word; }
    </style>
</head>
<body class="bg-gray-100 text-slate-800 font-sans overflow-hidden">

    <div id="app" class="flex flex-col md:flex-row app-height w-full">
        
        <!-- Left Panel: Itinerary Book -->
        <!-- Mobile: Order 2 (Bottom), Height 70% (Increased space) -->
        <div class="order-2 md:order-1 w-full md:w-[45%] flex flex-col h-[70%] md:h-full bg-white shadow-xl z-20 border-r border-gray-200">
            
            <!-- Header -->
            <div class="p-3 md:p-4 bg-slate-900 text-white shadow-md z-10 shrink-0">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-base md:text-lg font-bold"><i class="fa-solid fa-book-open mr-2"></i>2026 é¦–çˆ¾å®Œå…¨é«”è¡Œç¨‹</h1>
                    </div>
                    <div class="text-right text-xs text-slate-400 hidden md:block">
                        <div>06/01 - 06/08</div>
                        <div>ä¹æ¨¹ ROKAUS é¾å±±</div>
                    </div>
                </div>
            </div>

            <!-- Day Tabs -->
            <div id="day-tabs" class="flex overflow-x-auto whitespace-nowrap bg-slate-50 border-b border-slate-200 p-2 shrink-0 no-scrollbar">
                <button 
                    v-for="(day, index) in schedule" 
                    :key="index"
                    :id="'day-btn-' + index"
                    @click="selectDay(index)"
                    :class="['flex-none px-4 py-2 rounded-lg text-sm font-bold mr-2 transition-all border', 
                             currentDayIndex === index ? 'bg-slate-800 text-white border-slate-800 shadow' : 'bg-white text-slate-600 border-slate-200']"
                >
                    Day {{ index + 1 }}
                </button>
                <div class="w-4 flex-none"></div>
            </div>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto p-4 custom-scrollbar bg-slate-50 relative scroll-smooth" id="timeline-container">
                
                <!-- Day Summary Card -->
                <!-- Removed 'sticky top-0' on mobile to free up viewing space. Only sticky on md (desktop). -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6 md:sticky md:top-0 z-10">
                    <h2 class="text-lg md:text-xl font-black text-slate-800 mb-1">{{ currentDay.date }}</h2>
                    <h3 class="text-sm md:text-md font-bold text-slate-600 mb-3">{{ currentDay.title }}</h3>
                    <div class="flex flex-wrap gap-2 text-xs">
                        <span class="px-2 py-1 bg-orange-50 text-orange-700 rounded border border-orange-100">ğŸ½ï¸ åˆ: {{ currentDay.lunch }}</span>
                        <span class="px-2 py-1 bg-indigo-50 text-indigo-700 rounded border border-indigo-100">ğŸ½ï¸ æ™š: {{ currentDay.dinner }}</span>
                    </div>
                    <!-- Special Notice Box if exists -->
                    <div v-if="currentDay.notice" class="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800 leading-relaxed whitespace-pre-line">
                        <strong>âš ï¸ ç‰¹åˆ¥é ˆçŸ¥ï¼š</strong><br>{{ currentDay.notice }}
                    </div>
                </div>

                <!-- Timeline Events -->
                <div class="space-y-4 pb-20 relative px-2">
                    <!-- Vertical Line -->
                    <div class="absolute left-[19px] top-2 bottom-10 w-0.5 bg-slate-200 -z-0"></div>

                    <div 
                        v-for="(event, eIndex) in currentDay.events" 
                        :key="eIndex"
                        @click="focusEvent(event)"
                        :class="['relative pl-8 transition-all duration-200 group cursor-pointer', 
                                 activeEvent === event ? 'scale-[1.01]' : '']"
                    >
                        <!-- Dot -->
                        <div :class="['absolute left-[11px] top-4 w-4 h-4 rounded-full border-2 border-white shadow z-10', 
                                     getCategoryColor(event.category)]">
                        </div>

                        <!-- Card -->
                        <div :class="['p-4 rounded-lg border shadow-sm transition-colors text-sm',
                                      activeEvent === event ? 'bg-white border-slate-400 ring-1 ring-slate-400' : 'bg-white border-slate-200 hover:border-slate-300']">
                            
                            <!-- Time & Loc -->
                            <div class="flex justify-between items-start mb-2">
                                <span class="font-mono font-bold text-slate-700 bg-slate-100 px-2 py-0.5 rounded text-xs">{{ event.time }}</span>
                                <i :class="['fa-solid text-slate-400', getCategoryIcon(event.category)]"></i>
                            </div>
                            <h4 class="font-bold text-slate-800 text-base mb-2">{{ event.location }}</h4>
                            
                            <!-- Detailed Note (Word for word) -->
                            <div v-if="event.note" class="text-slate-600 text-xs leading-relaxed note-content" v-html="formatNote(event.note)"></div>

                            <!-- Tags -->
                            <div v-if="event.tags" class="mt-3 flex flex-wrap gap-1">
                                <span v-for="tag in event.tags" :class="['text-[10px] px-1.5 py-0.5 rounded border', getTagStyle(tag)]">
                                    {{ tag }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Right Panel: Map -->
        <!-- Mobile: Order 1 (Top), Height 30% (Reduced) -->
        <div id="map-container" class="order-1 md:order-2 w-full md:w-[55%] bg-slate-200 relative z-10">
            <div id="map" class="w-full h-full outline-none"></div>
            <!-- Legend -->
            <div class="absolute bottom-6 right-4 bg-white/95 backdrop-blur p-3 rounded-lg shadow-lg text-xs z-[1000] hidden md:block border border-slate-200">
                <div class="font-bold mb-2 text-slate-700">åœ–ä¾‹ Legend</div>
                <div class="grid grid-cols-2 gap-x-4 gap-y-2">
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-blue-500 mr-2"></span>æ™¯é»</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-orange-500 mr-2"></span>ç¾é£Ÿ</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-purple-500 mr-2"></span>è³¼ç‰©</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-green-500 mr-2"></span>äº¤é€š</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-gray-600 mr-2"></span>ä½å®¿</div>
                    <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-sky-500 mr-2"></span>èˆªç­</div>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                // --- Data: äº¤é€šé¢¨éšªæ ¡æ­£çµ‚æ¥µç‰ˆ ---
                const schedule = ref([
                    {
                        date: "06/01 (ä¸€) Day 1",
                        title: "é«˜é›„ â” é¦–çˆ¾ (ç§»å‹•æ—¥)",
                        lunch: "æ©Ÿä¸Š/æ©Ÿå ´",
                        dinner: "å¤–é€ (çµå¥‡å¹´ç³•/æ©‹æ‘ç‚¸é›)",
                        events: [
                            { time: "12:00", location: "å®¶è£¡å‡ºç™¼", category: "transport", note: "ğŸ•’ æ™‚é–“ï¼šé è¨ˆ 12:00-12:30 å‡ºé–€ (ä¿ç•™ç·©è¡)\nç›®æ¨™ï¼šé«˜é›„å°æ¸¯æ©Ÿå ´ (KHH)", coords: null },
                            { time: "13:30", location: "æŠµé”æ©Ÿå ´ & è¾¦ç†ç™»æ©Ÿ", category: "flight", note: "âœˆï¸ èˆªç­ï¼šå°ç£è™èˆª IT662\nâš ï¸ å‹•ä½œï¼šæ‰˜é‹è¡Œæã€é ˜ç™»æ©Ÿè­‰ã€éå®‰æª¢", coords: [22.5768, 120.3478] },
                            { time: "15:15", location: "ã€ç™»æ©Ÿæ™‚é–“ Boardingã€‘", category: "alert", note: "ğŸ“ å‹•ä½œï¼šå‰å¾€ç™»æ©Ÿé–€æº–å‚™æ’éšŠ\nâš ï¸ æ­»ç·šï¼šç™»æ©Ÿé–€é€šå¸¸æ–¼ 15:35 é—œé–‰ï¼Œè«‹å‹¿é²åˆ°", coords: null },
                            { time: "15:55", location: "èµ·é£› (å‰å¾€é¦–çˆ¾é‡‘æµ¦)", category: "flight", note: "é è¨ˆé£›è¡Œæ™‚é–“ç´„ 2å°æ™‚45åˆ†", coords: null },
                            { time: "19:40", location: "æŠµé”é‡‘æµ¦æ©Ÿå ´ (GMP)", category: "transport", note: "å…¥å¢ƒã€æé ˜è¡Œæ", coords: [37.5587, 126.8028] },
                            { time: "20:30", location: "äº¤é€šï¼šæ©Ÿå ´ â” é£¯åº—", category: "transport", note: "ğŸš• æ–¹å¼ï¼šè¨ˆç¨‹è»Š\nğŸ•’ æ™‚é–“ï¼šä¿®æ­£ä¼° 45-60 åˆ†é˜ (ç´å…¥æ™šé–“å¡è»Šé¢¨éšª)\nğŸ’° è»Šè³‡ï¼šç´„ 25,000 éŸ“å…ƒèµ·", coords: [37.5587, 126.8028] },
                            { time: "20:50", location: "ã€é—œéµå‹•ä½œã€‘å«å¤–é€æ±ºç­–", category: "alert", note: "A. é †åˆ©ä¸Šè»Šï¼šåœ¨è¨ˆç¨‹è»Šä¸Šå« (é ä¼° 21:10 æŠµé”)\nB. å»¶èª¤/å¡è»Šï¼šæŠµé”é£¯åº—å†å« (æ”¹é»æ©‹æ‘ç‚¸é›ï¼Œè¼ƒè€æ”¾)", coords: null },
                            { time: "21:10", location: "ä¹æ¨¹ ROKAUS é¾å±±", category: "hotel", note: "æŠµé” Check-in (å·²é 15:00 å¯ç›´æ¥å…¥æˆ¿)", coords: [37.5293, 126.9654] },
                            { time: "21:30", location: "å¤§å»³å–é¤åƒå®µå¤œ", category: "food", note: "ã€Plan Aã€‘çµå¥‡è¾£ç‚’å¹´ç³• (éœ€ 21:20 å‰ä¸‹å–®)\nã€Plan Bã€‘æ©‹æ‘ç‚¸é› (è‹¥è¶•ä¸ä¸Šå¹´ç³•æ”¹åƒé€™å€‹)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/02 (äºŒ) Day 2",
                        title: "å¤¢ç¢³(SOP)ï¼‹åŠ å±±Outlet(å‹•ç·šå„ªåŒ–)",
                        lunch: "å¤¢ç¢³ (ç‡’è‚‰)",
                        dinner: "Outlet è‡ªç†",
                        events: [
                            { time: "10:00", location: "äº¤é€šï¼šé£¯åº— â” å¤¢ç¢³", category: "transport", note: "ğŸ“ åœ°å€ï¼šé¦–çˆ¾ é¾å±±å€ ç™½å‡¡è·¯99è¡— 50\nğŸšŒ æ¨è–¦ï¼šå…¬è»Š (ç´„ 11 åˆ†é˜ / æœ€å¿«) â” [ä¸‰è§’åœ°ç«™] ä¸‹è»Š\nğŸš¶ å‚™æ¡ˆï¼šæ­¥è¡Œ (ç´„ 23 åˆ†é˜ / 1.4km / Naver Map é©—è­‰)", coords: [37.5372, 126.9698] },
                            { time: "10:40", location: "å¤¢ç¢³ï¼šæŠµé”ç¾å ´æº–å‚™å€™ä½", category: "food", note: "âš ï¸ è¦å‰‡ï¼š11:00 é–‹æ”¾ç¾å ´æ©Ÿå°ç™»è¨˜ (ä¸å¯æŒ‡å®šæ™‚é–“/ç„¡é ç´„)\nğŸ“‹ å‹•ä½œï¼š10:40 å‰æŠµé” â” 11:00 æº–æ™‚æ“ä½œæ©Ÿå°\nğŸ›‘ é¢¨éšªæ§ç®¡ï¼šè‹¥éœ€ç­‰ 3hr+ï¼Œç›´æ¥å•Ÿå‹•å‚™æ¡ˆåˆé¤", tags: ["æ’éšŠé—œéµ"], coords: [37.5372, 126.9698] },
                            { time: "ä¸Šåˆ", location: "é™„è¿‘å’–å•¡å»³ç­‰å¾…", category: "food", note: "å¦‚: Approach Coffee", coords: [37.5288, 126.9715] },
                            { time: "12:00", location: "åˆé¤ï¼šå¤¢ç¢³ (ç‡’è‚‰)", category: "food", note: "ğŸ•’ ç‡Ÿæ¥­ï¼š12:00 é–‹å§‹å«è™Ÿå…¥åº§\nğŸ•’ é ä¼°åœç•™ï¼šç´„ 1.5 - 2 å°æ™‚", coords: [37.5372, 126.9698] },
                            { time: "14:30", location: "ã€ç©ºçª—æœŸæ±ºç­–ï¼š14:30-16:00ã€‘", category: "alert", note: "ğŸ’¡ é¸é … A (å‘³é“é‡/éœ€è£œå¦)ï¼šå›é£¯åº— (15:30 å¿…é ˆå‡ºç™¼)\nğŸ’¡ é¸é … B (ç²¾ç¥ä½³)ï¼šAmore Pacific ç¸½éƒ¨ (15:40 å¿…é ˆé›¢é–‹)\nğŸ’¡ é¸é … C (äººæ½®ç„¦æ…®)ï¼šç›´æ¥ææ—©å» Outlet (æˆ°åŠ›æœ€å¼·åŒ–)", coords: [37.5293, 126.9654] },
                            { time: "16:00", location: "äº¤é€šï¼šé¾å±± â” åŠ å±±æ•¸ç¢¼åœ’å€", category: "transport", note: "ğŸš‡ åœ°éµï¼š1è™Ÿç·š [é¾å±±] â” [åŠ å±±æ•¸ç¢¼åœ’å€] (å¾€ä»å·/æ°´åŸæ–¹å‘)\nğŸ•’ æ™‚é–“ï¼šå…¨ç¨‹ç´„ 35-40 åˆ†é˜ (å«æ­¥è¡Œèˆ‡å€™è»Š)", coords: [37.4815, 126.8826] },
                            { time: "16:40", location: "Mario Outlet (1/2/3é¤¨)", category: "shopping", note: "âš ï¸ é€²å ´ SOPï¼š1.å…ˆæ‹æ¨“å±¤å°è¦½ 2.é–å®šç›®æ¨™å“ç‰Œæ¨“å±¤\nâ¶ [16:40-17:50] 2é¤¨ (Leisure)ï¼šå…ˆæ”»æ©Ÿèƒ½ (North Face, K2)\nâ· [17:50-19:20] 3é¤¨ (Mario Mall)ï¼šå†æ”»æ½®æµ (MLB, Discovery)\nâ¸ [19:20-20:00] æ±ºç­–èˆ‡è¤‡é©—\nâ¹ [20:00-20:30] æ™šé¤ (3é¤¨ç¾é£Ÿè¡—)", tags: ["æˆ°åŠ›å…¨é–‹"], coords: [37.4784, 126.8887] },
                            { time: "20:30", location: "äº¤é€šï¼šåŠ å±± â” é¾å±±", category: "transport", note: "ğŸš‡ åœ°éµï¼š1è™Ÿç·šç›´é” [é¾å±±ç«™] (ç´„ 35-40 åˆ†é˜)", coords: [37.5293, 126.9654] },
                            { time: "21:15", location: "æŠµé”é£¯åº—", category: "hotel", note: "æ•´ç†å¤§é‡æˆ°åˆ©å“", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/03 (ä¸‰) Day 3",
                        title: "é¾ç†åœ˜è·¯ï¼‹ç‹é·—äº­ï¼‹æ¼¢å—æ´",
                        lunch: "é¾ç†åœ˜è·¯æ—©åˆé¤",
                        dinner: "æ¼¢å—æ´ 24H é¦¬éˆ´è–¯æ¹¯",
                        events: [
                            { time: "09:30", location: "äº¤é€šï¼šé£¯åº— â” é¾ç†åœ˜è·¯", category: "transport", note: "ğŸ’¡ ç­–ç•¥ï¼šååº—ä½æ–¼ã€Œä¸‰è§’åœ°ç«™ã€ï¼Œå»ºè­°æ­è»Š\nğŸš‡ åœ°éµï¼š4è™Ÿç·š [æ–°é¾å±±] â” [ä¸‰è§’åœ°] (æ­1ç«™)\nğŸšŒ å…¬è»Šï¼šè—è‰²å·´å£« 100/150 ç­‰ (æ­2ç«™)", coords: [37.5312, 126.9705] },
                            { time: "ä¸Šåˆ", location: "æ—©åˆé¤ååº—ã€ä¸‰é¸ä¸€ã€‘", category: "food", note: "â¶ Dotori (æ©¡å¯¦)ï¼šç‰¹è‰²å„ªæ ¼ (æ­¥è¡Œç´„ 20-23 åˆ†é˜ / 1.1km)\nâ· SAM SAM SAMï¼šç¾å¼å¾©å¤å®¶å¸¸èœ (æ­¥è¡Œç´„ 20 åˆ†é˜ / 1.0km)\nâ¸ Teddy Beurre Houseï¼šæ³•å¼å¯é Œ (æ­¥è¡Œç´„ 16-18 åˆ†é˜ / 0.9km)", coords: [37.5312, 126.9705] },
                            { time: "12:00", location: "äº¤é€šï¼šé¾ç†åœ˜è·¯ â” ç‹é·—äº­", category: "transport", note: "ğŸš• å»ºè­°ï¼šè¨ˆç¨‹è»Š (è·¨å€æœ€å¿«)\nğŸ•’ æ™‚é–“ï¼šä¿®æ­£ä¼° 25-35 åˆ†é˜ (è¦–æ¼¢å—å¤§æ©‹è·¯æ³)\nğŸ’³ å‚™æ¡ˆï¼šåœ°éµè½‰ä¹˜ç´„ 40 åˆ†é˜", coords: [37.5273, 127.0392] },
                            { time: "ä¸‹åˆ", location: "ç‹é·—äº­ / ç¾…å¾·å¥§", category: "shopping", note: "å³¶å±±å…¬åœ’å‘¨é‚Šï¼šé€›ç²¾å“èˆ‡æ½®ç‰Œ\né ä¼°åœç•™ï¼šç´„ 3.5 - 4 å°æ™‚", coords: [37.5273, 127.0392] },
                            { time: "16:00", location: "äº¤é€šï¼šç‹é·—äº­ â” æ¼¢å—æ´", category: "transport", note: "ğŸ’³ æ°£å€™å¡ï¼šå·´å£« 142 / 144 / 472 (é †å‘å›ç¨‹)\nğŸ•’ æ™‚é–“ï¼šå…¬è»Šç´„ 15-20 åˆ†é˜ + æ­¥è¡Œ", coords: [37.5348, 127.0012] },
                            { time: "ä¸‹åˆ", location: "æ¼¢å—æ´é€›è¡—", category: "shopping", note: "å°ˆæ”»è¨­è¨ˆå¸«æ½®ç‰Œ (Mardi, Maritheç­‰)\né ä¼°åœç•™ï¼šç´„ 3 å°æ™‚", coords: [37.5348, 127.0012] },
                            { time: "19:30", location: "æ­¥è¡Œå‰å¾€æ™šé¤", category: "transport", note: "å‰å¾€æ¼¢å—æ´ 24å°æ™‚é¦¬éˆ´è–¯æ’éª¨æ¹¯", coords: [37.5332, 127.0028] },
                            { time: "20:00", location: "æ™šé¤ï¼šé¦¬éˆ´è–¯æ’éª¨æ¹¯", category: "food", note: "æ¼¢å—æ´ 24å°æ™‚ç‡Ÿæ¥­ååº—", coords: [37.5332, 127.0028] },
                            { time: "21:30", location: "äº¤é€šï¼šæ¼¢å—æ´ â” é£¯åº—", category: "transport", note: "ğŸ’³ æ°£å€™å¡ï¼šå·´å£« 400 / 110B (ç›´é”é£¯åº—é™„è¿‘)\nğŸ•’ æ™‚é–“ï¼šå…¬è»Šç´„ 20 åˆ†é˜", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/04 (å››) Day 4",
                        title: "æ˜¥å·ä¸€æ—¥éŠ (ç‰§å ´ï¼‹éµé“)",
                        lunch: "æ˜æ´è¾£ç‚’é›æ’",
                        dinner: "è»Šç«™è‡ªç†",
                        notice: "1. [ç«è»Š] 5/4 07:00 æ¶ ITX (å»09:17/å›18:56)\n2. [é ç´„] æ˜¥å·å¤–åœ‹äººè§€å…‰è¨ˆç¨‹è»Š\n3. [é ç´„] æ±Ÿæ‘éµè·¯è‡ªè¡Œè»Š 16:30å ´\n4. [ç¾é‡‘] æº–å‚™ 8è¬éŸ“å…ƒä»˜è¨ˆç¨‹è»Š\n5. [è­‰ä»¶] å‹™å¿…å¸¶è­·ç…§",
                        events: [
                            { time: "09:17", location: "é¾å±±ç«™ (Yongsan)", category: "transport", note: "ğŸš„ æ­ä¹˜ ITX-é’æ˜¥è™Ÿå‡ºç™¼ (å»ºè­°è»Šä¸Šåƒæ—©é¤)", coords: [37.5298, 126.9647] },
                            { time: "10:40", location: "æŠµé”æ˜¥å·ç«™", category: "activity", note: "ğŸ“ å‹•ä½œï¼šå‰å¾€ 1 è™Ÿå‡ºå£ã€ŒTravel Islandã€æ«ƒæª¯\nğŸ“‹ ä»»å‹™ï¼šå‡ºç¤ºè­·ç…§ã€æ ¸å°é ç´„è³‡æ–™", coords: [37.8844, 127.7171] },
                            { time: "11:00", location: "è¨ˆç¨‹è»ŠåŒ…è»Šå•Ÿå‹•", category: "transport", note: "ğŸš• æŒ‡ä»¤ï¼šæº–æ™‚ä¸Šè»Š (ç›®æ¨™ 5hr / é ç®— 7è¬éŸ“å…ƒ)", coords: [37.8844, 127.7171] },
                            { time: "11:40", location: "å¹¸ç¦è‰åŸç‰§å ´", category: "activity", note: "ğŸ•’ åœç•™ï¼š1.5 å°æ™‚ (çˆ¬å¡æ‹çµ•æ™¯ã€é¤µç¶¿ç¾Š)", coords: [37.9472, 127.6703] },
                            { time: "13:35", location: "åœŸè±†éºµåŒ…", category: "food", note: "ğŸ¥¡ æŒ‡ä»¤ï¼šå¤–å¸¶æ¨¡å¼ (Takeout Only)\nâš ï¸ é‡é»ï¼šåªæ‹ç…§ï¼‹è²·éºµåŒ…å¤–å¸¶ï¼Œä¸å…§ç”¨ (çœæ™‚é—œéµ)", coords: [37.9255, 127.7812] },
                            { time: "14:20", location: "æ˜æ´è¾£ç‚’é›æ’è¡—", category: "food", note: "ğŸ•’ åœç•™ï¼š1 å°æ™‚\nâš ï¸ æ­»ç·š (GATE)ï¼š15:25 å¿…é ˆä¸Šè»Šé›¢é–‹", coords: [37.8797, 127.7283] },
                            { time: "15:45", location: "æŠµé”é‡‘è£•è²ç«™", category: "transport", note: "ğŸ›‘ è¨ˆç¨‹è»Šä»»å‹™çµæŸ\nğŸ’° ä»˜æ¬¾ï¼šæ”¯ä»˜ç¾é‡‘ç´„ 70,000 éŸ“å…ƒçµ¦å¸æ©Ÿ", coords: [37.8164, 127.7135] },
                            { time: "15:45", location: "å ±åˆ°ç·©è¡", category: "alert", note: "ğŸš» å‹•ä½œï¼šä¸Šå»æ‰€ã€æ›å¯¦é«”ç¥¨ã€16:10 å‰æŠµé”é›†åˆ", coords: [37.8164, 127.7135] },
                            { time: "16:30", location: "æ±Ÿæ‘éµè·¯è‡ªè¡Œè»Š", category: "activity", note: "ğŸ•’ é«”é©—ï¼šç´„ 1.5 å°æ™‚ (é¨è¡Œ50åˆ†+ç«è»Š20åˆ†+æ¥é§è»Š)", coords: [37.8164, 127.7135] },
                            { time: "18:15", location: "åœ°éµç§»å‹•", category: "transport", note: "ğŸš‡ æ­ä¹˜äº¬æ˜¥ç·šåœ°éµ (å¾€æ˜¥å·æ–¹å‘) å 1 ç«™", coords: [37.8164, 127.7135] },
                            { time: "18:25", location: "å—æ˜¥å·ç«™ (Namchuncheon)", category: "transport", note: "â˜• å‡ºç«™ä¼‘æ¯ã€è²·é›¶é£Ÿå€™è»Š", coords: [37.8638, 127.7239] },
                            { time: "18:56", location: "å›ç¨‹é¦–çˆ¾ (ITX)", category: "transport", note: "ğŸš„ ã€Plan Aã€‘å—æ˜¥å· 18:56 ç™¼ â” 20:11 æŠµé”é¾å±±\nğŸš„ ã€Plan Bã€‘å—æ˜¥å· 19:56 ç™¼ â” 21:14 æŠµé”é¾å±±", coords: [37.5298, 126.9647] }
                        ]
                    },
                    {
                        date: "06/05 (äº”) Day 5",
                        title: "é†«ç¾(3.5h)ï¼‹è–æ°´æ´(5h)",
                        lunch: "çƒ¤é»¨ (è–æ°´åº—)",
                        dinner: "è–æ°´é¦¬éˆ´è–¯æ’éª¨æ¹¯",
                        events: [
                            { time: "10:15", location: "äº¤é€šï¼šé¾å±± â” èˆå ‚", category: "transport", note: "ğŸ’³ æ°£å€™å¡ï¼šåœ°éµ 4è™Ÿç·š [æ–°é¾å±±] â” [èˆå ‚]\nğŸ•’ æ™‚é–“ï¼šç´„ 20 åˆ†é˜", coords: [37.4765, 126.9816] },
                            { time: "11:00", location: "èˆå ‚é†«ç¾ç™‚ç¨‹", category: "activity", note: "ğŸ•’ é ä¼°åœç•™ï¼š3 ~ 3.5 å°æ™‚ (å«è«®è©¢/éº»é†‰/æ–½ä½œ/ä¿®å¾©)", coords: [37.4765, 126.9816] },
                            { time: "14:40", location: "äº¤é€šï¼šèˆå ‚ â” è–æ°´", category: "transport", note: "ğŸ’³ åœ°éµ 2è™Ÿç·š [èˆå ‚] â” [è–æ°´]\nğŸ•’ æ™‚é–“ï¼šç´„ 40 åˆ†é˜\n*é€±äº”ä¸‹åˆå¿…å¡è»Šï¼Œå¼·çƒˆå»ºè­°æ­åœ°éµ", coords: [37.5445, 127.0560] },
                            { time: "15:20", location: "åˆæ™šé¤ï¼šçƒ¤é»¨ (è–æ°´åº—)", category: "food", note: "âš ï¸ æé†’ï¼šç¶²ç´…ååº—ï¼Œéœ€å€™ä½\n*ç­–ç•¥ï¼šå…ˆå»ç™»è¨˜å€™ä½ (Catchtable)ï¼Œè‹¥éœ€ä¹…å€™å‰‡å…ˆé€›è¡—", coords: [37.5428, 127.0543] },
                            { time: "ä¸‹åˆ", location: "è–æ°´æ´é€›è¡—", category: "shopping", note: "é ä¼°åœç•™ï¼šç´„ 4 - 5 å°æ™‚", coords: [37.5445, 127.0560] },
                            { time: "æ™šé¤", location: "è–æ°´é¦¬éˆ´è–¯æ’éª¨æ¹¯", category: "food", note: "æˆ– å’–å•¡å»³ç”œé»", coords: [37.5445, 127.0560] },
                            { time: "20:30", location: "äº¤é€šï¼šè–æ°´ â” é£¯åº—", category: "transport", note: "ğŸš• å»ºè­°ï¼šè¨ˆç¨‹è»Š (è¡“å¾Œå»ºè­°èˆ’é©ç§»å‹•)\nğŸ•’ æ™‚é–“ï¼šä¿®æ­£ä¼° 45-50 åˆ†é˜ (é€±äº”æ™šé–“å¡è»Šé¢¨éšª)\nğŸ’³ å‚™æ¡ˆï¼šåœ°éµè½‰ä¹˜ç´„ 45 åˆ†é˜ (è¼ƒç´¯)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/06 (å…­) Day 6",
                        title: "ç›Šå–„æ´ï¼‹æ–°ç¾…å…ç¨…",
                        lunch: "ç›Šå–„ç¿ éŸ¿ / ç„¡æ‹›ç‰Œåº—",
                        dinner: "é›æ—é£Ÿå ‚ (å‚™æ¡ˆ:ä¹™æ”¯ç²¾è‚‰)",
                        events: [
                            { time: "09:00", location: "Catchtable å–è™Ÿ", category: "alert", note: "é ç«¯å–è™Ÿï¼šArtist Bakery", coords: null },
                            { time: "10:00", location: "äº¤é€šï¼šé¾å±± â” å®‰åœ‹", category: "transport", note: "ğŸ’³ åœ°éµ 4è™Ÿç·šè½‰ 3è™Ÿç·š [å®‰åœ‹ç«™]\nğŸ•’ æ™‚é–“ï¼šç´„ 25 åˆ†é˜ (å‡æ—¥åœ°éµæœ€ç©©)", coords: [37.5766, 126.9854] },
                            { time: "10:30", location: "Artist Bakery", category: "food", note: "é¹½éºµåŒ…å¤–å¸¶/é»å¿ƒ\nè²·å®Œå¾Œå¯åœ¨å®‰åœ‹ç«™å‘¨é‚Šç¨ä½œä¼‘æ¯", coords: [37.5768, 126.9850] },
                            { time: "12:00", location: "åˆé¤ï¼šç¾©å¼æ–™ç†ã€äºŒé¸ä¸€ã€‘", category: "food", note: "â¶ Ikseon Chwihyang (ç›Šå–„ç¿ éŸ¿)\nâ· Ganpan Eopneun Gage (ç„¡æ‹›ç‰Œåº—)", coords: [37.5744, 126.9905] },
                            { time: "13:30", location: "ç›Šå–„æ´éŸ“å±‹æ‘", category: "activity", note: "æ°›åœå’–å•¡å»³/æ–‡å‰µå°ç‰©\nâ˜• æ¨è–¦ï¼šæ¸…æ°´å ‚ / æ¨‚åœ’é©›", coords: [37.5744, 126.9905] },
                            { time: "15:15", location: "äº¤é€šï¼šç›Šå–„æ´ â” æ–°ç¾…å…ç¨…", category: "transport", note: "ğŸš• å¼·çƒˆå»ºè­°ï¼šè¨ˆç¨‹è»Š (çœåŠ›ä¸”å¿«é€Ÿ)\nğŸ•’ æ™‚é–“ï¼šä¿®æ­£ä¼° 20-25 åˆ†é˜ (å‡æ—¥å¸‚å€è»Šå¤š)", coords: [37.5562, 127.0084] },
                            { time: "15:40", location: "æ–°ç¾…å…ç¨…åº— é¦–çˆ¾åº—", category: "shopping", note: "ğŸ•’ é ä¼°åœç•™ï¼šç´„ 2 å°æ™‚ (å«è¾¦å¡ã€è©¦è‰²ã€çµå¸³)", coords: [37.5562, 127.0084] },
                            { time: "17:40", location: "äº¤é€šï¼šå…ç¨…åº— â” é˜è·¯3è¡—", category: "transport", note: "ğŸš• å»ºè­°ï¼šè¨ˆç¨‹è»Š (ç´„ 15-20 åˆ†é˜)", coords: [37.5714, 126.9915] },
                            { time: "18:00", location: "æ™šé¤ï¼šé›æ—é£Ÿå ‚ æœ¬åº—", category: "food", note: "ğŸ“ ä½ç½®ï¼šé˜è·¯3è¡—ç«™ 12 è™Ÿå‡ºå£é™„è¿‘\nğŸ’¡ ã€å‚™æ¡ˆ Plan Bã€‘ä¹™æ”¯ç²¾è‚‰ (æ­¥è¡Œ 5-8 åˆ†é˜)", coords: [37.5714, 126.9915] },
                            { time: "20:00", location: "äº¤é€šï¼šé˜è·¯3è¡— â” é£¯åº—", category: "transport", note: "ğŸ’³ åœ°éµ 1è™Ÿç·šç›´é” [é¾å±±ç«™]", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/07 (æ—¥) Day 7",
                        title: "å‰ªé«®ï¼‹æœ›é ï¼‹å¼˜å¤§ï¼‹æ–°æ‘",
                        lunch: "æœ›é å¸‚å ´å°åƒ",
                        dinner: "æ–°æ‘ å¥¶è¾£ç‡‰æ’éª¨",
                        events: [
                            { time: "10:20", location: "äº¤é€šï¼šé¾å±± â” åˆäº•", category: "transport", note: "ğŸ’³ åœ°éµ 4è™Ÿç·šè½‰ 6è™Ÿç·š [åˆäº•ç«™]\nğŸ•’ æ™‚é–“ï¼šç´„ 20-25 åˆ†é˜ (è½‰ä¹˜æœ€çœåŠ›)\nğŸš• å‚™æ¡ˆï¼šè¨ˆç¨‹è»Šç´„ 15-20 åˆ†é˜", coords: [37.5488, 126.9133] },
                            { time: "11:00", location: "åˆäº•ç«™é«®å»Š", category: "activity", note: "ğŸ•’ é ä¼°åœç•™ï¼šç´„ 4 å°æ™‚ (å‰ª+æŸ“/ç‡™)", coords: [37.5488, 126.9133] },
                            { time: "15:00", location: "äº¤é€šï¼šåˆäº• â” æœ›é ", category: "transport", note: "ğŸ’³ åœ°éµ 6è™Ÿç·š (åƒ… 1 ç«™)", coords: [37.5561, 126.9064] },
                            { time: "15:20", location: "æœ›é å¸‚å ´", category: "food", note: "åƒé›¨è€³æ¨‚ç‚¸è¾£æ¤’ã€å¯æ¨‚é¤…\nåœç•™ç´„ 1.5 å°æ™‚", coords: [37.5561, 126.9064] },
                            { time: "16:40", location: "äº¤é€šï¼šæœ›é  â” å¼˜å¤§", category: "transport", note: "ğŸ’³ åœ°éµ 6è™Ÿç·šè½‰ 2è™Ÿç·š", coords: [37.5575, 126.9245] },
                            { time: "17:00", location: "å¼˜å¤§å…¥å£ç«™ 8 è™Ÿå‡ºå£", category: "shopping", note: "è—¥å±€/ç¾å¦ å¿«é€Ÿè£œè²¨", coords: [37.5575, 126.9245] },
                            { time: "19:00", location: "äº¤é€šï¼šå¼˜å¤§ â” æ–°æ‘", category: "transport", note: "ğŸš¶ æ­¥è¡Œï¼šæ²¿äº¬ç¾©ç·šæ›¸è¡—æ•£æ­¥ç´„ 15-20 åˆ†é˜", coords: [37.5551, 126.9369] },
                            { time: "19:30", location: "æ™šé¤ï¼šæ–°æ‘ å¥¶è¾£ç‡‰æ’éª¨", category: "food", note: "é ä¼°åœç•™ï¼šç´„ 1.5 å°æ™‚", coords: [37.5551, 126.9369] },
                            { time: "21:00", location: "äº¤é€šï¼šæ–°æ‘ â” é£¯åº—", category: "transport", note: "ğŸ’¡ ç­–ç•¥ï¼šé€±æ—¥æ™šé–“å¼˜å¤§/æ–°æ‘å€æ˜“å¡è»Šï¼Œå»ºè­°å„ªå…ˆæ­åœ°éµ\nğŸš‡ åœ°éµï¼š2è™Ÿç·šè½‰ 1è™Ÿç·š (å…¨ç¨‹ç´„ 25-30 åˆ†é˜ï¼Œæœ€ç©©)", coords: [37.5293, 126.9654] }
                        ]
                    },
                    {
                        date: "06/08 (ä¸€) Day 8",
                        title: "é€€æˆ¿ç©ºæª”(4h)ï¼‹æ©Ÿå ´å ±åˆ°",
                        lunch: "I-Park Mall/è¶…å¸‚",
                        dinner: "æ©Ÿä¸Š/æ©Ÿå ´",
                        events: [
                            { time: "10:00", location: "æ•´ç†è¡Œæ & æº–å‚™ Check-out", category: "hotel", note: "", coords: [37.5293, 126.9654] },
                            { time: "11:00", location: "è¾¦ç†é€€æˆ¿", category: "hotel", note: "ğŸ§³ å‹•ä½œï¼šå°‡è¡Œæå¯„æ”¾åœ¨é£¯åº—æ«ƒå°", coords: [37.5293, 126.9654] },
                            { time: "11:15", location: "ã€ç©ºçª—æœŸï¼š11:15-16:30ã€‘", category: "shopping", note: "æœ€å¾Œæƒè²¨ (ç´„ 4-5 å°æ™‚)\nğŸ’¡ å»ºè­° Aï¼šEmart é¾å±±åº—\nğŸ’¡ å»ºè­° Bï¼šiPark Mall", coords: [37.5286, 126.9640] },
                            { time: "16:30", location: "å›åˆ°é£¯åº—é ˜å–è¡Œæ", category: "hotel", note: "", coords: [37.5293, 126.9654] },
                            { time: "17:00", location: "äº¤é€šï¼šé£¯åº— â” é‡‘æµ¦æ©Ÿå ´", category: "transport", note: "ğŸš• å»ºè­°ï¼šè¨ˆç¨‹è»Š (å‹™å¿…é ç•™å¡è»Šç·©è¡)\nğŸ•’ æ™‚é–“ï¼šä¿®æ­£ä¼° 50-60 åˆ†é˜ (ä¸‹ç­å°–å³°æ™‚æ®µé¢¨éšª)\nğŸ’° è»Šè³‡ï¼šç´„ 25,000-30,000 éŸ“å…ƒ", coords: [37.5587, 126.8028] },
                            { time: "17:50", location: "æŠµé”é‡‘æµ¦æ©Ÿå ´ & å ±åˆ°", category: "flight", note: "1. è¨—é‹è¡Œæ (Check-in)\n2. è¾¦ç†é€€ç¨…ï¼š2æ¨“æµ·é—œè“‹ç«  -> 3æ¨“é€€ç¨…æ«ƒå°", coords: [37.5587, 126.8028] },
                            { time: "18:30", location: "é€šéå®‰æª¢ & è­‰ç…§æŸ¥é©—", category: "alert", note: "é ä¼° 20-30 åˆ†é˜", coords: null },
                            { time: "19:00", location: "é ˜å–å…ç¨…å“ & é€€ç¨…é‡‘", category: "shopping", note: "ğŸ“ ä½ç½®ï¼šé€šéå®‰æª¢å¾Œ 3æ¨“ 34è™Ÿç™»æ©Ÿé–€é™„è¿‘\nâš ï¸ è¨»ï¼šæ‰€æœ‰å…ç¨…åº—çš†åœ¨åŒä¸€è™•æè²¨", coords: null },
                            { time: "19:55", location: "ã€ç™»æ©Ÿæ™‚é–“ Boardingã€‘", category: "alert", note: "èµ·é£›å‰ 40 åˆ†é˜\nâš ï¸ æé†’ï¼šè«‹ç¢ºä¿å·²é ˜å®Œå…ç¨…å“ï¼Œé¿å…å£“ç·š", coords: null },
                            { time: "20:35", location: "èµ·é£›è¿”ç¨‹ (å›é«˜é›„)", category: "flight", note: "âœˆï¸ å°ç£è™èˆª IT663", coords: null },
                            { time: "22:40", location: "æŠµé”é«˜é›„å°æ¸¯æ©Ÿå ´", category: "transport", note: "å¹³å®‰å›å®¶", coords: [22.5768, 120.3478] }
                        ]
                    }
                ]);

                // --- Logic & Map ---
                const currentDayIndex = ref(0);
                const currentDay = ref(schedule.value[0]);
                const activeEvent = ref(null);
                let map = null;
                let markers = [];

                const formatNote = (text) => {
                    // Highlight warnings
                    return text.replace(/(âš ï¸|ğŸ›‘|ã€|ã€‘)/g, '<span class="text-orange-600 font-bold">$1</span>');
                };

                const getCategoryColor = (cat) => {
                    const map = { activity: 'bg-blue-500 border-blue-200', food: 'bg-orange-500 border-orange-200', shopping: 'bg-purple-500 border-purple-200', transport: 'bg-green-500 border-green-200', hotel: 'bg-gray-600 border-gray-300', flight: 'bg-sky-500 border-sky-200', alert: 'bg-red-500 border-red-200' };
                    return map[cat] || 'bg-gray-400';
                };

                const getCategoryIcon = (cat) => {
                    const map = { activity: 'fa-camera', food: 'fa-utensils', shopping: 'fa-bag-shopping', transport: 'fa-train-subway', hotel: 'fa-bed', flight: 'fa-plane', alert: 'fa-circle-exclamation' };
                    return map[cat] || 'fa-location-dot';
                };

                const getTagStyle = (tag) => {
                    if (tag.includes("é¢¨éšª") || tag.includes("æ­»ç·š")) return 'bg-red-100 text-red-700 border-red-200';
                    return 'bg-slate-100 text-slate-600 border-slate-200';
                };

                // Initialize Map
                const initMap = () => {
                    map = L.map('map', { zoomControl: false, padding: [20, 20] }).setView([37.5665, 126.9780], 13);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                        attribution: '&copy; OpenStreetMap &copy; CARTO', maxZoom: 20
                    }).addTo(map);
                    L.control.zoom({ position: 'topright' }).addTo(map);
                    renderMarkers();
                };

                // Render Markers
                const renderMarkers = () => {
                    markers.forEach(m => map.removeLayer(m));
                    markers = [];
                    const bounds = L.latLngBounds();
                    let hasCoords = false;

                    currentDay.value.events.forEach((event) => {
                        if (event.coords) {
                            hasCoords = true;
                            // Create Custom Icon
                            const iconHtml = `<div class="flex items-center justify-center w-full h-full text-white text-xs rounded-full shadow-lg ${getCategoryColor(event.category).split(' ')[0]}"><i class="${getCategoryIcon(event.category)}"></i></div>`;
                            const icon = L.divIcon({
                                className: 'custom-marker',
                                html: iconHtml,
                                iconSize: [28, 28],
                                iconAnchor: [14, 14],
                                popupAnchor: [0, -14]
                            });

                            const marker = L.marker(event.coords, { icon: icon }).addTo(map);
                            marker.bindPopup(`<div class="text-center font-bold text-slate-800">${event.location}</div>`, { closeButton: false });
                            
                            marker.on('click', () => focusEvent(event));
                            
                            marker.eventData = event;
                            markers.push(marker);
                            bounds.extend(event.coords);
                        }
                    });

                    if (hasCoords) map.fitBounds(bounds, { padding: [50, 50], maxZoom: 15 });
                };

                // Actions
                const selectDay = (index) => {
                    currentDayIndex.value = index;
                    currentDay.value = schedule.value[index];
                    activeEvent.value = null;
                    document.getElementById('timeline-container').scrollTop = 0;
                    
                    nextTick(() => {
                        // Scroll tab into view
                        const btn = document.getElementById('day-btn-' + index);
                        if (btn) btn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                        renderMarkers();
                    });
                };

                const focusEvent = (event) => {
                    activeEvent.value = event;
                    if (event.coords && map) {
                        map.flyTo(event.coords, 16, { animate: true, duration: 1 });
                        markers.forEach(m => {
                            if (m.eventData === event) m.openPopup();
                            else m.closePopup();
                        });
                    }
                };

                onMounted(() => initMap());

                return { schedule, currentDay, currentDayIndex, activeEvent, selectDay, focusEvent, getCategoryColor, getCategoryIcon, getTagStyle, formatNote };
            }
        }).mount('#app');
    </script>
</body>
</html>
